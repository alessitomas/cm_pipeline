---
title: 'CM++ - A Meta-method for Well-Connected Community Detection'
tags:
    - CM++
    - connectivity
    - minimum cut
    - complex network analysis
    - graph
    - network
    - degree
    - clustering
authors:
    - name: Vikram Ramavarapu
      orcid: 0009-0001-8875-7213
      affiliation: 1
      email: vikramr2@illinois.edu
    - name: Fábio Jose Ayres
      orcid: 0009-0000-6821-4687
      affiliation: 2
    - name: Minhyuk Park
      orcid: 0000-0002-8676-7565
      affiliation: 1
    - name: Vidya Kamath Pailodi
      orcid: 0009-0000-0987-5901
      affiliation: 1
    - name: João Alfredo Cardoso Lamy
      orcid: 0009-0005-4744-4754
      affiliation: 2
    - name: Tandy Warnow
      orcid: 0000-0001-7717-3514
      affiliation: 1
    - name: George Chacko
      orcid: 0000-0002-2127-1892
      affiliation: 1
      corresponding: true
affiliations:
    - name: Department of Computer Science, University of Illinois Urbana-Champaign, IL 61801, USA
      index: 1
    - name: Insper Institute, Sao Paulo, Brazil
      index: 2

date:
bibliography: paper.bib

---

# Introduction

Community detection methods help uncover the meso-scale structure of networks and have broad applications [@https://doi.org/10.1002/asi.22748; @Haggerty2013; @Karatas2018; @https://doi.org/10.1002/wics.1566]. While communities can be defined in different ways [@https://doi.org/10.1002/sam.10133], a common expectation is one of greater edge-density within and lesser edge density between communities [@Fortunato2022]. A related expectation is that communities also should be well-connected [@Traag2019; @BONCHI202134].

In @park2023wellconnected, we describe Connectivity Modifier (CM), a meta-method that enforces well-connectedness in communities. As input, CM takes a network, a clustering of the network generated by an algorithm, and a user-specified connectivity threshold. For each community (cluster), CM uses VieCut [@henzinger2018practical] to find a small edge cut, and if the edge cut size is below the specified connectivity threshold, then the cut is removed, and the partitions are reclustered using the clustering algorithm. This process repeats until all clusters are well connected.

We now present CM++ [@cm_pipe2023], which uses parallelism for scalability and has new features. CM++  provides support for additional clustering paradigms and is designed to be extensible by other developers. Concurrently, we present the CM++ Pipeline, a modular and extensible workflow that automates CM++ operations. The pipeline consists of clustering, pre-processing, connectivity modifier (CM++), and post-processing stages with generation of cluster statistics.

# Statement of Need

We have demonstrated that several widely-used algorithms and packages, such as `leidenalg` and Markov Clustering, do not generate well-connected clusters [@park2023wellconnected]. A tool to enforce user-specified levels of well-connectedness to clusterings from multiple community detection methods is not presently available. <!---CM++ enables a user to specify a minimum level of well-connectedness and apply it to multiple clustering paradigms. CM++ and its pipeline allow a user to choose from clustering paradigms and the level of connectedness.-->

![(Top) A visualization of a workflow created from the CM++ Pipeline. (Bottom right) Algorithmic schematic of CM++. CM++ splits the queue of clusters evenly between the spawned processes. Each process runs an instance of CM++ on its share of clusters (recursive mincutting and reclustering until well connected). (Bottom left) Runtime curve with respect to the number of parallel cores running CM++. CEN (14 million nodes, 1.3 billion edges) is the Curated Exosome Network. orkut (3.1 million nodes, 117 million edges) and cit_patents (3.7 million nodes, 16 million edges) are both from the SNAP database [@snapnets] and processed through the removal of parallel edges and self-loops [@park2023wellconnected].](figures/Slide3.png)

# CM++: Enforcing Well-Connectedness 

CM++ is a meta-method designed to modify an existing network clustering, ensuring that each cluster achieves connectivity values above a user-defined threshold. Key Features:

- **Flexibility:** For users to accompany their definition of a good community with well-connectedness, CM++ is designed to work with any clustering algorithm and presently provides built-in support for the Leiden algorithm (optimizing either the Constant Potts Model or modularity) [@Traag2019], Iterative K-core Clustering (IKC) [@10.1162/qss_a_00184], and Infomap [@doi:10.1073/pnas.0706851105].
- **Dynamic Thresholding:** In order to allow the enforcement of connectivity to be flexible, connectivity thresholds can be constants, or functions of the number of nodes in the cluster, or the minimum node degree of the cluster.
- **Multi-processing:** For better performance, users can specify a larger number of cores to process clusters concurrently.

## Example Commands

- `python3 -m hm01.cm -i network.tsv -e clustering.tsv -o output.tsv -c leiden -g 0.5 --threshold 1log10 --nprocs 4 --quiet`
- `python3 -m hm01.cm -i network.tsv -e clustering.tsv -o output.tsv -c ikc -k 10 --threshold 1log10 --nprocs 4 --quiet`

These commands run on Leiden with resolution 0.5 and IKC with k-core value 10 clusterings respectively. They both use four cores and set a dynamic threshold of $log_{10}(n)$ where every cluster with a minimum cut above the base-10 logarithm of the number of nodes is considered "well-connected".

# CM++ Pipeline: A Flexible and User-Friendly Community Detection Pipeline

The CM Pipeline is a modular pipeline for community detection, containing functions that can be reordered and modified. Key Features:

- **Graph Cleaning:** Removal of parallel and duplicate edges as well as self loops.
- **Community Detection:** Clusters an input network with one of Leiden, IKC, and InfoMap.
- **Cluster Filtration:** A pre-processing stage that allows users to filter out clusters that are trees or have size below a given threshold. 
- **Community Statistics Reporting:** Generates node and edge count, modularity score, Constant Potts Model score, conductance, and edge-connectivity at multiple stages.
- **Extensibility:** Developers can remove stages and design new ones.

# Limitations

The current version of CM++ offers a limited range of built-in clustering options, but is designed to simplify extension by other developers. With IKC, CM++ has failed to complete on clusters on the order of a million nodes due to very high memory usage. CM++ is limited to community detection algorithms that yield disjoint communities, so algorithms that yield overlapping communities are not supported by CM++.

## Parallel Strategy

In its current form, CM++ distributes the input clusters roughly equally across available cores. Each core runs an instance of CM++, and outputs are aggregated at the end. This strategy may suffer from load balancing issues if there are large outliers in cluster size. A version is being developed that uses a shared memory queue of clusters that each core can fetch from. <!---This strategy should be much better at load balancing, this implementation needs improvement as it is slower in practice. -->

# Conclusions

CM++ offers performant improvements over its predecessor CM. The accompanying pipeline provides additional functionality and is customizable, allowing users to re-order modules and add custom modules.

# Acknowledgements

This work was supported in part by the Insper-Illinois Collaboration and by Oracle Research Awards to Tandy Warnow and George Chacko. The authors thank Nathan Bryans and Christine Ballard from Oracle Research for their assistance with the Oracle Cloud Infrastructure.  

# References
